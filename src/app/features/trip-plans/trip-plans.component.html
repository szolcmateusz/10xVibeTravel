<div class="p-4">
  <h1 class="text-2xl font-bold mb-6">My Trip Plans</h1>
  
  @if (error()) {
    <mat-card class="mb-4">
      <mat-card-content class="text-red-600">
        {{ error() }}
      </mat-card-content>
    </mat-card>
  }

  @if (loading()) {
    <div class="flex justify-center my-8">
      <mat-spinner diameter="48" />
    </div>
  }

  @if (!loading() && tripPlans()) {
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
      @for (plan of tripPlans()!.data; track plan.id) {
        <mat-card class="flex flex-col h-full">
          <mat-card-header>
            <mat-card-title>{{ plan.location }}</mat-card-title>
            <mat-card-subtitle>
              <mat-icon inline>date_range</mat-icon>
              {{ plan.date_from | date:'mediumDate' }} - {{ plan.date_to | date:'mediumDate' }}
            </mat-card-subtitle>
          </mat-card-header>
          <mat-card-actions align="end" class="mt-auto">            
            <button mat-button color="primary" (click)="handleEdit(plan)">
              <mat-icon>edit</mat-icon>
              Edit
            </button>
            <button mat-button color="warn" (click)="handleDelete(plan)">
              <mat-icon>delete</mat-icon>
              Delete
            </button>
          </mat-card-actions>
        </mat-card>
      }
    </div>

    <mat-paginator
      [length]="tripPlans()!.pagination.total"
      [pageSize]="tripPlans()!.pagination.limit"
      [pageIndex]="tripPlans()!.pagination.page - 1"
      [pageSizeOptions]="[10, 20, 50]"
      (page)="handlePageEvent($event)"
      aria-label="Select page of trip plans"
      class="mt-4"
    />
  }
  
  @if (!loading() && (!tripPlans() || tripPlans()!.data.length === 0)) {
    <mat-card>
      <mat-card-content class="flex flex-col items-center py-8">
        <mat-icon class="text-4xl mb-4">flight_takeoff</mat-icon>
        <p class="text-lg">No trip plans yet</p>
        <button mat-raised-button color="primary" class="mt-4" (click)="handleCreateTripPlan()">
          Create Your First Trip Plan
        </button>
      </mat-card-content>
    </mat-card>
  }
</div>